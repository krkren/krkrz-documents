<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- generated by to_html.pl from GraphicSystem.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Graphic System</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="Standard style for KiriKiri reference" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="Top Page" />
</head>
<body>
<h1><a id="id142" name="id142">About the Graphic System</a>
</h1><div class="para"><div>
 KiriKiri has a graphic display mechanism using layers.<br />
 Each layer has functions for transparent overlaying via alpha blending and hierarchical structure management. Additionally, it has a mechanism (focus) for receiving user input so that layers can operate as GUI components (widgets).<br />
<br />
 Overlaid layers are drawn to the window by a mechanism called a draw device. By default, a device called BasicDrawDevice is used, which simply draws the layer output to the window. The draw device can be freely replaced by manipulating the <a target="main" class="jump" href="f_Window_drawDevice.html">Window.drawDevice</a> property, allowing users to define their own visual effects (in the form of plugins) according to their needs, but KiriKiri Z only includes the aforementioned BasicDrawDevice.</div></div>
<h1><a id="id143" name="id143">Readable and Writable Image Formats</a>
</h1><div class="para"><div>
 The formats that can be read into or written from a layer using <a target="main" class="jump" href="f_Layer_loadImages.html">Layer.loadImages</a> in the standard state of KiriKiri are as follows.<br />
<br />
<dl>
<dt>BMP</dt>
<dd> Standard Windows bitmap format. 32 bpp BMPs are treated as bitmaps with an alpha channel.<br />
 RLE-compressed bitmaps cannot be read.</dd>
<dt>PNG</dt>
<dd> Portable Network Graphic format can be read. PNGs with an alpha channel can also be read.</dd>
<dt>JPEG</dt>
<dd> JPEG format can be read. Arithmetically compressed or losslessly compressed JPEGs cannot be read, but since these are rarely seen, it should not be an issue.</dd>
<dt>TLG5</dt>
<dd> KiriKiri's original lossless compression format. The extension is .tlg. Images with an alpha channel can also be read. While the compression ratio is not very high, it features high-speed decompression. This format <em>cannot be used for mask images (_m) or province images (_p)</em>. It can only handle full-color images without an alpha channel, or full-color images with an alpha channel.</dd>
<dt>TLG6</dt>
<dd> KiriKiri's original lossless compression format. The extension is .tlg, same as TLG5. TLG6 features a high compression ratio. Decompression speed takes nearly twice as long as TLG5, but it is still more than twice as fast as PNG, and the size is 20-40% smaller than PNG.</dd>
<dt>JPEG XR</dt>
<dd> JPEG XR format can be read. It is lossy but offers higher quality than JPEG and supports alpha channels.<br />
 When compressed with a priority on image quality, it is difficult to distinguish from lossless images, and since the file size is small, it is useful when size is important.<br />
 Supported since Ver 1.1.0, currently only reading is supported.<br />
 Saving is supported since Ver 1.3.0.<br />
</dd>
<dt>Main/Mask Separated Format</dt>
<dd> This is a format where the color information image (main) and the alpha channel (mask) image are separate. The mask image is the main image's filename with _m appended (for example, abc_m.jpeg for abc.jpeg).<br />
 The formats of the main and mask images do not have to be the same.</dd></dl><br />
 Additionally, you can increase the number of readable image formats using Susie Plug-ins. Susie plug-ins can be loaded with the <a target="main" class="jump" href="f_Plugins_link.html">Plugins.link</a> method.<br />
 If a 32bpp bitmap is passed from a Susie Plug-in, it is treated as a bitmap with an alpha channel.<br />
<br />
</div></div>
<h1><a id="id144" name="id144">Layer Types</a>
</h1><div class="para"><div>
 KiriKiri layers can be displayed in various composition modes (layer types).<br />
 The following composition modes are available, and layer type constants starting with lt can be specified in the <a target="main" class="jump" href="f_Layer_type.html">Layer.type</a> property.<br />
 In the formulas, <span class="i">result</span> is the result, <span class="i">dest</span> is the luminance of the destination image, <span class="i">src</span> is the luminance of the source image to be overlaid, and <span class="i">alpha</span> is the alpha value per pixel of the source image. All values range from 0.0 to 1.0.<br />
 Also, the following functions are defined here for explanation:<br />
<ul><li>abs(<span class="i">a</span>) : absolute value of <span class="i">a</span></li><li>max(<span class="i">a</span>, <span class="i">b</span>) : the larger of <span class="i">a</span> or <span class="i">b</span></li><li>min(<span class="i">a</span>, <span class="i">b</span>) : the smaller of <span class="i">a</span> or <span class="i">b</span></li><li>blend(<span class="i">a</span>, <span class="i">b</span>, <span class="i">r</span>) = <span class="i">a</span> * (1.0 - <span class="i">r</span>) + <span class="i">b</span> * <span class="i">r</span></li></ul><br />
<dl>
<dt><a id="id145" name="id145" class="targanchor"><dfn>ltOpaque</dfn></a> (<a id="id146" name="id146" class="targanchor"><dfn>ltCoverRect</dfn></a>)</dt>
<dd> ltOpaque is a display without transparency. The entire rectangle of the layer is always completely opaque (this is not limited to this layer type, but if the opacity is lowered with <a target="main" class="jump" href="f_Layer_opacity.html">Layer.opacity</a>, it will follow that).<br />
<br />
Formula : <span class="i">result</span> = <span class="i">src</span><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
ltCoverRect has the same meaning, but it is an old name used in versions prior to 2.23 beta 2.</div><br />
</dd>
<dt><a id="id147" name="id147" class="targanchor"><dfn>ltAlpha</dfn></a> (<a id="id148" name="id148" class="targanchor"><dfn>ltTransparent</dfn></a>)</dt>
<dd> ltAlpha performs alpha blending. This is the most basic type for transparency. The following formula is also used for alpha channel input from BMP or Susie plug-ins.<br />
<br />
Formula : <span class="i">result</span> = blend(<span class="i">dest</span>, <span class="i">src</span>, <span class="i">alpha</span>)<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
ltTransparent has the same meaning, but it is an old name used in versions prior to 2.23 beta 2.</div><br />
</dd>
<dt><a id="id149" name="id149" class="targanchor"><dfn>ltAddAlpha</dfn></a></dt>
<dd> ltAddAlpha performs additive alpha blending.<br />
 The <a target="main" class="jump" href="TPC.html">Image Format Converter</a> can output images suitable for this format. Also, you can convert from ltAlpha to this format using the <a target="main" class="jump" href="f_Layer_convertType.html">Layer.convertType</a> method.<br />
 ltAddAlpha layers cannot be displayed correctly if they are direct children of an ltAlpha layer.<br />
<br />
Formula : <span class="i">result</span> = min(1.0, <span class="i">dest</span> * ( 1.0 - <span class="i">alpha</span> ) + <span class="i">src</span>)<br />
</dd>
<dt><a id="id150" name="id150" class="targanchor"><dfn>ltAdditive</dfn></a></dt>
<dd> ltAdditive performs additive blending. Suitable for expressing glows. It is "Linear Dodge" in Photoshop, but if you want the same effect as Photoshop, use ltPsAdditive described later. Unlike ltPsAdditive, alpha is ignored in ltAdditive.<br />
 The neutral color (the color that does not change when overlaid) is black.<br />
<br />
Formula : <span class="i">result</span> = min(1.0, <span class="i">dest</span> + <span class="i">src</span>)<br />
</dd>
<dt><a id="id151" name="id151" class="targanchor"><dfn>ltSubtractive</dfn></a></dt>
<dd> ltSubtractive performs subtractive blending. alpha is ignored.<br />
 The neutral color is white.<br />
<br />
Formula : <span class="i">result</span> = max(0.0, <span class="i">dest</span> + <span class="i">src</span> - 1.0)<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
 The only difference from <span class="i">result</span> = <span class="i">dest</span> - <span class="i">src</span> is whether src is inverted or not.</div><br />
</dd>
<dt><a id="id15
<?xml version="1.0" encoding="UTF-8" ?>
<doc>
<title>Bitmap</title>
<desc>
 The Bitmap class is a class that holds image information.<r/>
</desc>

<member>
	<name>Bitmap</name>
	<type>constructor</type>
	<shortdesc>Constructs a Bitmap object</shortdesc>
	<arg></arg>
	<result></result>
	<desc>
		 Constructs a Bitmap class object.<r/>
		 In the initial state, the width and height are 32 pixels.<r/>
	</desc>
</member>

<member>
	<name>Bitmap</name>
	<type>constructor</type>
	<shortdesc>Constructs a Bitmap object</shortdesc>
	<arg>
		<argitem>
			<name>width</name>
			<default></default>
			<desc>
				 Specifies the width of the image.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>height</name>
			<default></default>
			<desc>
				 Specifies the height of the image.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>bpp</name>
			<default>32</default>
			<desc>
				 Specifies the number of bits per pixel for the image.<r/>
				 Please specify either 32 or 8.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Constructs a Bitmap class object with the specified size.<r/>
	</desc>
</member>

<member>
	<name>Bitmap</name>
	<type>constructor</type>
	<shortdesc>Constructs a Bitmap object</shortdesc>
	<arg>
		<argitem>
			<name>filename</name>
			<default></default>
			<desc>
				 Specifies the filename of the image.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>colorkey</name>
			<default>clNone</default>
			<desc>
				 Specifies the color key.<r/>
				 The value is the same as in <ref>Layer.loadImages</ref>.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Constructs a Bitmap class object from a file.<r/>
	</desc>
</member>

<member>
	<name>onLoaded</name>
	<type>event</type>
	<shortdesc>Asynchronous loading completed</shortdesc>
	<arg>
		<argitem>
			<name>meta</name>
			<default></default>
			<desc>
				 Tag information of the loaded image.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>async</name>
			<default></default>
			<desc>
				 Whether it was loaded asynchronously.<r/>
				 If the image data is in the cache, this event occurs during the execution of <ref>Bitmap.loadAsync</ref>.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>error</name>
			<default></default>
			<desc>
				 Whether an error occurred during image loading.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>message</name>
			<default></default>
			<desc>
				 Error message.<r/>
				 If an error occurs, the error message is passed.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Occurs when asynchronous loading is completed.<r/>
		 The loaded image can be copied to a Layer using <ref>Layer.copyFromBitmapToMainImage</ref>.<r/>
		 Since the loading process is asynchronous, the Layer to which the image is passed may have already been invalidated by the time loading is complete.<r/>
		 When accessing other objects in this event, please check if they have been invalidated.<r/>
		 Alternatively, ensure that the target object is not invalidated until this event is completed.<r/>
	</desc>
	<ref>Bitmap.loadAsync</ref>
	<ref>Layer.copyFromBitmapToMainImage</ref>
</member>

<member>
	<name>getPixel</name>
	<type>method</type>
	<shortdesc>Get pixel value</shortdesc>
	<arg>
		<argitem>
			<name>x</name>
			<default></default>
			<desc>
				 Specifies the x-coordinate value to get, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>y</name>
			<default></default>
			<desc>
				 Specifies the y-coordinate value to get, in pixels.<r/>
			</desc>
		</argitem>
	</arg>
	<result>Pixel value</result>
	<desc>
		 Gets the pixel value of the image.<r/>
	</desc>
	<ref>Bitmap.setPixel</ref>
</member>

<member>
	<name>setPixel</name>
	<type>method</type>
	<shortdesc>Set pixel value</shortdesc>
	<arg>
		<argitem>
			<name>x</name>
			<default></default>
			<desc>
				 Specifies the x-coordinate value to set, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>y</name>
			<default></default>
			<desc>
				 Specifies the y-coordinate value to set, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>value</name>
			<default></default>
			<desc>
				 Specifies the pixel value to set.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Sets the pixel value of the image.<r/>
	</desc>
	<ref>Bitmap.getPixel</ref>
</member>

<member>
	<name>getMaskPixel</name>
	<type>method</type>
	<shortdesc>Get pixel alpha value</shortdesc>
	<arg>
		<argitem>
			<name>x</name>
			<default></default>
			<desc>
				 Specifies the x-coordinate value to get, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>y</name>
			<default></default>
			<desc>
				 Specifies the y-coordinate value to get, in pixels.<r/>
			</desc>
		</argitem>
	</arg>
	<result>Pixel alpha value</result>
	<desc>
		 Gets the alpha value of the image pixel.<r/>
	</desc>
	<ref>Bitmap.setMaskPixel</ref>
</member>

<member>
	<name>setMaskPixel</name>
	<type>method</type>
	<shortdesc>Set pixel alpha value</shortdesc>
	<arg>
		<argitem>
			<name>x</name>
			<default></default>
			<desc>
				 Specifies the x-coordinate value to set, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>y</name>
			<default></default>
			<desc>
				 Specifies the y-coordinate value to set, in pixels.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>value</name>
			<default></default>
			<desc>
				 Specifies the alpha value of the pixel to set.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Sets the alpha value of the image pixel.<r/>
	</desc>
	<ref>Bitmap.getMaskPixel</ref>
</member>

<member>
	<name>independ</name>
	<type>method</type>
	<shortdesc>Break image sharing</shortdesc>
	<arg>
		<argitem>
			<name>copy</name>
			<default>true</default>
			<desc>
				 Specifies whether to copy the original image when breaking the sharing state.<r/>
				 If true is specified, the original image is copied. If false is specified, the original image is not copied, and the content of the image becomes undefined.
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Forcibly breaks the image sharing state.<r/>
		 In Kirikiri, when an image is copied entirely using assignImages or similar methods, the image buffer is not actually copied; instead, the same image is shared.<r/>
		 Normally, this sharing state is automatically broken just before an attempt is made to modify the image, but it can be forcibly broken with this method.<r/>
		 If false is specified for the copy argument, the image sharing is broken, but it is not guaranteed that the original image will be inherited (the image content becomes undefined), however, breaking the sharing can be done faster.<r/>
		 If you are going to overwrite the entire image, there is no need to inherit the original image, so calling this method with false before drawing may improve efficiency.<r/>
		 This method does nothing if the image is not shared.<r/>
	</desc>
</member>

<member>
	<name>setSize</name>
	<type>method</type>
	<shortdesc>Set image size</shortdesc>
	<arg>
		<argitem>
			<name>width</name>
			<default></default>
			<desc>
				 Specifies the width of the image in pixels.<r/>
				 This value can also be retrieved or set using the <ref>Bitmap.width</ref> property.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>height</name>
			<default></default>
			<desc>
				 Specifies the height of the image in pixels.<r/>
				 This value can also be retrieved or set using the <ref>Bitmap.height</ref> property.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Specifies the image size.<r/>
	</desc>
</member>

<member>
	<name>copyFrom</name>
	<type>method</type>
	<shortdesc>Copy image</shortdesc>
	<arg>
		<argitem>
			<name>src</name>
			<default></default>
			<desc>
				 Specifies the source Bitmap object to copy from.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Performs an image copy.<r/>
		 Although it is called a copy, it actually only results in a state where "the same image is shared by two or more objects," so this method takes almost no execution time.<r/>
	</desc>
</member>


<member>
	<name>save</name>
	<type>method</type>
	<shortdesc>Save image</shortdesc>
	<arg>
		<argitem>
			<name>name</name>
			<default></default>
			<desc>
				 Specifies the storage name to save to.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>type</name>
			<default>"bmp"</default>
			<desc>
				 Specifies the image format to save as a string. The following formats can be specified in the current version.<r/>
				<r/>
				<dl>
				<dt>"<kw>bmp</kw>" or "<kw>bmp32</kw>"</dt>
				<dd>
					 32bpp BMP. Also saves the alpha channel (mask).<r/>
				</dd>
				<r/>
				<dt>"<kw>bmp24</kw>"</dt>
				<dd>
					 24bpp BMP. The alpha channel (mask) is not saved.<r/>
				</dd>
				<r/>
				<dt>"<kw>bmp8</kw>"</dt>
				<dd>
					 8bpp BMP. The alpha channel (mask) is not saved. The image is reduced using 4x4 organized dithering with a fixed palette of 252 colors.<r/>
				</dd>
				<r/>
				<dt>"<kw>jpg</kw>"</dt>
				<dd>
					 JPEG. The alpha channel (mask) is not saved. The image is saved with 90% quality.<r/>
				</dd>
				<r/>
				<dt>"<kw>jpg###</kw>"</dt>
				<dd>
					 JPEG. The alpha channel (mask) is not saved. The image is saved with the quality specified by ###. "jpg010" for 10%, "jpg100" for 100%, "jpg080" for 80%.<r/>
				</dd>
				<r/>
				<dt>"<kw>png</kw>"</dt>
				<dd>
					 32bpp PNG. Also saves the alpha channel (mask).<r/>
				</dd>
				<r/>
				<dt>"<kw>png24</kw>"</dt>
				<dd>
					 24bpp PNG. The alpha channel (mask) is not saved.<r/>
				</dd>
				<r/>
				<dt>"<kw>tlg5</kw>"</dt>
				<dd>
					 32bpp TLG5. Also saves the alpha channel (mask).<r/>
				</dd>
				<r/>
				<dt>"<kw>tlg524</kw>"</dt>
				<dd>
					 24bpp TLG5. The alpha channel (mask) is not saved.<r/>
				</dd>
				<r/>
				<dt>"<kw>tlg6</kw>"</dt>
				<dd>
					 32bpp TLG6. Also saves the alpha channel (mask).<r/>
				</dd>
				<r/>
				<dt>"<kw>tlg624</kw>"</dt>
				<dd>
					 24bpp TLG6. The alpha channel (mask) is not saved.<r/>
				</dd>
				<r/>
				</dl>
			</desc>
		</argitem>
		<argitem>
			<name>meta</name>
			<default>null</default>
			<desc>
				 For TLG format, specifies the tag information to save in dictionary format.<r/>
				 For other formats, specifies additional options (version 1.3.0 or later).<r/>
				 Available options can be retrieved with getSaveOption.<r/>
			</desc>
		</argitem>
		
	</arg>
	<result></result>
	<desc>
		 Saves the file to the storage (file) specified by name in the image format specified by type.<r/>
	</desc>
	<ref>Bitmap.getSaveOption</ref>
</member>

<member>
	<name>load</name>
	<type>method</type>
	<shortdesc>Load image</shortdesc>
	<arg>
		<argitem>
			<name>image</name>
			<default></default>
			<desc>
				 Specifies the image storage to load.<r/>
			</desc>
		</argitem>
		<argitem>
			<name>colorkey</name>
			<default>clNone</default>
			<desc>
				 Specifies the color key (transparent color) of the image to be loaded.<r/>
				 If a color is specified in 0xRRGGBB format, that color will be the color key.<r/>
				 If a value obtained by adding an arbitrary palette index to <tt><kw>clPalIdx</kw></tt> is specified, that palette index will be the transparent color (for images with 256 colors or less).<r/>
				 If <tt><kw>clAdapt</kw></tt> is specified, the most frequently used color in the top line of the image automatically becomes the transparent color.<r/>
				 If a value obtained by adding a numerical value representing a color in 0xRRGGBB format to <tt><kw>clAlphaMat</kw></tt> is specified, the image is overlaid on that color using alpha blending (ltAlpha method).
				 For example, if (clAlphaMat + 0xffffff) is specified, the loaded image is overlaid on white.
				 The image will be entirely opaque
				 (Note that while the image becomes entirely opaque, the tag information is not changed at all in this mode).<r/>
			</desc>
		</argitem>
	</arg>
	<result>Dictionary array of tag information</result>
	<desc>
		 Loads an image.<r/>
		 Returns a dictionary array of tag information (information about the image itself, such as the layer type and display position of that image) as the return value.<r/>
		 If the image does not have tag information, null is returned.<r/>
		 In the current version, only PNG and TLG5/6 formats can have tag information. For information that can be retrieved, please refer to <link href="TPC"/>.<r/>
	</desc>
</member>

<member>
	<name>loadAsync</name>
	<type>method</type>
	<shortdesc>Asynchronous image loading</shortdesc>
	<arg>
		<argitem>
			<name>image</name>
			<default></default>
			<desc>
				 Specifies the image storage to load.<r/>
				 Note that the filename specified here must include the extension.<r/>
				 If there is no extension, the file will not be found and an error will occur.<r/>
			</desc>
		</argitem>
	</arg>
	<result></result>
	<desc>
		 Loads an image asynchronously.<r/>
		 Completion of loading can be received with <ref>Bitmap.onLoaded</ref>.<r/>
		 Whether asynchronous loading is in progress can be checked with <ref>Bitmap.loading</ref>.<r/>
		 Accessing members other than <ref>Bitmap.loading</ref> during asynchronous loading will cause an exception.<r/>
		 Please also check the description of <ref>Bitmap.onLoaded</ref>.<r/>
	</desc>
	<ref>Bitmap.onLoaded</ref>
	<ref>Bitmap.loading</ref>
	<ref>Layer.copyFromBitmapToMainImage</ref>
</member>

<member>
	<name>loadHeader</name>
	<type>method</type>
	<shortdesc>Load image information (1.3.0 or later)</shortdesc>
	<arg>
		<argitem>
			<name>image</name>
			<default></default>
			<desc>
				 Specifies the image storage to load.<r/>
				 Note that the filename specified here must include the extension.<r/>
				 If there is no extension, the file will not be found and an error will occur.<r/>
			</desc>
		</argitem>
	</arg>
	<result>Dictionary array of information</result>
	<desc>
		 Loads only the image information.<r/>
		 Since the image itself is not loaded, it can be read quickly when you only want to get information.<r/>
		 The width and height in the returned dictionary are mandatory, and other information depends on the image format.<r/>
	</desc>
</member>

<member>
	<name>getSaveOption</name>
	<type>method</type>
	<shortdesc>Get additional image saving information (1.3.0 or later)</shortdesc>
	<arg>
		<argitem>
			<name>type</name>
			<default></default>
			<desc>
				 Specifies the image format.<r/>
				 The specification method is the same as the save method.<r/>
			</desc>
		</argitem>
	</arg>
	<result>Dictionary array of additional information</result>
	<desc>
		 Retrieves additional information that can be specified when saving an image.<r/>
	</desc>
	<ref>Bitmap.save</ref>
</member>


<member>
	<name>width</name>
	<type>property</type>
	<shortdesc>Image width</shortdesc>
	<access>r/w</access>
	<desc>
		 Specifies the width of the image in pixels.<r/>
		 You can also set the value.<r/>
	</desc>
	<ref>Bitmap.setSize</ref>
</member>

<member>
	<name>height</name>
	<type>property</type>
	<shortdesc>Image height</shortdesc>
	<access>r/w</access>
	<desc>
		 Specifies the height of the image in pixels.<r/>
		 You can also set the value.<r/>
	</desc>
	<ref>Bitmap.setSize</ref>
</member>

<member>
	<name>buffer</name>
	<type>property</type>
	<shortdesc>Image buffer pointer</shortdesc>
	<access>r</access>
	<desc>
		 Represents a pointer to the upper-left corner of the image buffer (a 32bpp bitmap containing color and mask (opacity) information).<r/>
		 This property exists to provide a means of direct access to the image buffer for plugins and such.<r/>
		 It is returned as an integer type, but in plugins, please cast it to an appropriate type (such as const unsigned long *).<r/>
		 Do not write values to the pointer obtained with this property.
		 You can write to a pointer obtained with <ref>Bitmap.bufferForWrite</ref>.<r/>
		 The size of the image is represented by the <ref>Bitmap.width</ref> and <ref>Bitmap.height</ref> properties.<r/>
		 Refer to <ref>Bitmap.bufferPitch</ref> for the pointer calculation method.<r/>
	</desc>
	<ref>Bitmap.bufferForWrite</ref>
	<ref>Bitmap.bufferPitch</ref>
</member>

<member>
	<name>bufferForWrite</name>
	<type>property</type>
	<shortdesc>Image buffer pointer (for writing)</shortdesc>
	<access>r</access>
	<desc>
		 Represents a pointer to the upper-left corner of the image buffer (a 32bpp bitmap containing color and mask (opacity) information).<r/>
		 This property exists to provide a means of direct access to the image buffer for plugins and such.<r/>
		 It is returned as an integer type, but in plugins, please cast it to an appropriate type (such as unsigned long *).<r/>
		 Unlike <ref>Bitmap.buffer</ref>, you can write values to the pointer obtained with this property. Kirikiri shares exactly the same image among multiple objects, but referencing this property will break that sharing state.<r/>
		 The size of the image is represented by the <ref>Bitmap.width</ref> and <ref>Bitmap.height</ref> properties.<r/>
		 Refer to <ref>Bitmap.bufferPitch</ref> for the pointer calculation method.<r/>
	</desc>
	<ref>Bitmap.buffer</ref>
	<ref>Bitmap.bufferPitch</ref>
</member>

<member>
	<name>bufferPitch</name>
	<type>property</type>
	<shortdesc>Image buffer pitch</shortdesc>
	<access>r</access>
	<desc>
		 Represents the pitch of the image buffer (the number of bytes to the scanline immediately below) for the image (a 32bpp bitmap containing color and mask (opacity) information).<r/>
		 This property exists to provide a means of direct access to the image buffer for plugins and such.<r/>
		 Assuming tjs_uint32 is a 32-bit integer type and tjs_uint8 is an 8-bit (1 byte) integer type, the pointer to the image position (x, y) can be calculated as follows in C language:<r/>
		<tt>( (tjs_uint32*)( (tjs_uint8*)buffer + y*bufferPitch )) + x</tt><r/>
		 Note that this property returns the number of bytes, not the number of pixels, to the next scanline. This value may be slightly larger than the number of bytes exactly required for the image width.<r/>
		 Please be aware that this property value can be negative.<r/>
	</desc>
	<ref>Bitmap.buffer</ref>
	<ref>Bitmap.bufferForWrite</ref>
</member>

<member>
	<name>loading</name>
	<type>property</type>
	<shortdesc>Check if asynchronous loading is in progress</shortdesc>
	<access>r</access>
	<desc>
		 Indicates whether asynchronous loading is in progress.<r/>
		 When this value is true, asynchronous loading is in progress.<r/>
		 Please note that accessing other members during asynchronous loading will cause an exception.<r/>
	</desc>
	<ref>Bitmap.buffer</ref>
	<ref>Bitmap.bufferPitch</ref>
</member>


</doc>
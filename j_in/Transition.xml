<?xml version="1.0" encoding="UTF-8" ?>
<doc>
<title>About Transitions</title>

<para>
<ptitle>What are Transitions?</ptitle>
 Transitions are used to swap screens over a period of time. Kirikiri Z transitions can be performed on a single layer or on a layer tree.<r/>
 If a transition source is specified for a layer, the two layers will be swapped.<r/>
 In the former case, the corresponding layer is swapped; in the latter case, the entire layer tree structure is swapped.<r/>
 Please refer to the <at href="f_Layer_beginTransition.html">Layer.beginTransition</at> method.<r/>
<r/>
 Kirikiri Z manages transitions using what are called "<kw>transition handlers</kw>". These are specified by the name argument of the Layer.beginTransition method, and the current version includes three built-in handlers within the Kirikiri core. They can also be extended via plugins.<r/>
<r/>
 The following describes the transition handlers built into the Kirikiri core and those made available by the extended transition plugin ( extrans.dll ).<r/>
</para>

<para>
<ptitle>Specifying Options</ptitle>
<r/>
<dl>
<dt>When using from TJS2</dt>
<dd>
 Specify options as a dictionary array in the options argument of the Layer.beginTransition method. For example, to specify a "universal" transition with vague=100 time=2000 rule=rule1.png, specify the options argument as follows:<r/>
<r/>
<tt>%[vague:100, time:2000, rule:"rule1.png"]</tt>
</dd>
<dt>When using from KAG</dt>
<dd>
 In KAG, options are written directly as attributes in the trans tag. However, there are other attributes to specify besides options ( layer, children, method attributes ). You will specify the options along with these attributes.<r/>
 For example, to perform a "universal" transition on the base layer including child layers with vague=100 time=2000 rule=rule1.png, do the following:<r/>
<r/>
<tt>@trans layer=base children=true method=universal vague=100 time=2000 rule=rule1.png</tt><r/>
<r/>
 Also, for example, if you want to use the "wave" transition with maxomega=0.1 maxh=20, do the following:<r/>
<r/>
<tt>@trans layer=base children=true method=wave maxomega=0.1 maxh=20</tt>
</dd>
</dl>
</para>

<para>
<ptitle>Built-in Transition Handlers</ptitle>
 Kirikiri has the following three transition handlers built-in.<r/>
<r/>
<dl>
<dt><kw>crossfade</kw></dt>
<dd>
 The "crossfade" transition (crossfade transition) is the simplest transition, performing a basic crossfade.<r/>
 The options are as follows:<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>
</dl>

</dd>

<dt><kw>universal</kw></dt>
<dd>
 The "universal" transition (universal transition) performs a transition according to a grayscale image called a rule image. The rule image is specified with the rule option; darker areas of this image transition to the source ( the back buffer in KAG ) sooner.<r/>
 If the rule image is smaller than the screen being transitioned, it is tiled; if it is larger, only the top-left portion is used.<r/>
 Detailed explanations can be found in the KAG reference.<r/>
 The options are as follows:<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>rule (Required)</dt>
<dd>
 Specifies the rule image filename. The rule image must be a 256-level grayscale image. If any other image is specified, it will be forcibly converted to grayscale.
</dd>

<dt>vague</dt>
<dd>Specifies the "vague area value". Specifying a small value ( like 0 ) makes the boundary between the pre-transition and post-transition areas sharp. Specifying a large value ( like 128 ) makes this boundary blurred and smooth. The optimal value depends on the rule image. If omitted, 64 is assumed.
</dd>
</dl>

</dd>

<dt><kw>scroll</kw></dt>
<dd>
 The "scroll" transition (scroll transition) allows for scrolling effects by sliding either the source, the destination, or both.<r/>
 The options are as follows:<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>from</dt>
<dd>
 Specifies the direction from which the source layer ( the back page in KAG ) appears.<r/>
 When specifying in TJS, sttLeft appears from the left (default), sttTop from the top, sttRight from the right, and sttBottom from the bottom.<r/>
 When specifying in the KAG trans tag, "left" appears from the left (default), "top" from the top, "right" from the right, and "bottom" from the bottom.
</dd>

<dt>stay</dt>
<dd>
 Specifies how the source and destination images move.<r/>
 When specifying in TJS, ststNoStay causes the destination image to be pushed out by the source image (default). This creates an effect of two screens scrolling together. ststStaySrc causes the destination image to move out, revealing the source image from behind. ststStayDest keeps the destination image stationary while the source image moves in over it.<r/>
 When specifying in KAG, "nostay" represents ststNoStay, "stayback" represents ststStaySrc, and "stayfore" represents ststStayDest.
</dd>
</dl>

</dd>
</dl>
</para>


<para>
<ptitle>Extended Transition Plugin</ptitle>
 The extended transition plugin ( extrans.dll ) is a plugin for Kirikiri Z that enables several transitions not built into the core.<r/>
 To enable it, like other plugins, you must link it using the <at href="f_Plugins_link.html">Plugins.link</at> method ( or the loadplugin tag in KAG ). Simply by linking, the following transition handlers become available.<r/>
<r/>
<dl>
<dt>wave</dt>
<dd>
The "wave" (wave) transition expresses and switches transitions using waves via raster scrolling.<r/>
<r/>
<img src="wave_trans.jpg"/><r/>
<r/>
 The following options are available.<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>wavetype</dt>
<dd>
 Specifies the wave motion. 0: waves are fine at the start and end, and broad in the middle. 1: waves start fine and gradually become broader. 2: waves start broad and gradually become finer. Default is 0.
</dd>

<dt>maxh</dt>
<dd>
 Specifies the maximum width of the wave in pixels. Larger values result in deeper waves. Default is 50.
</dd>

<dt>maxomega</dt>
<dd>
 Specifies the maximum angular velocity ( rad/pixel ) of the wave. Larger values make the waves finer. Smaller values make them broader. Default is 0.2.
</dd>

<dt>bgcolor1</dt>
<dd>
 Specifies the initial background color in 0xRRGGBB format.
</dd>

<dt>bgcolor2</dt>
<dd>
 Specifies the final background color in 0xRRGGBB format. The background color starts at the initial color and gradually changes to the final color.
</dd>
</dl>

</dd>


<dt>mosaic</dt>
<dd>
The "mosaic" (mosaic) transition creates an effect like a rectangular mosaic.<r/>
<r/>
<img src="mosaic_trans.png"/><r/>
<r/>
 The following options are available.<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>maxsize</dt>
<dd>
 Specifies the maximum size of the mosaic rectangles. Default is 30. Larger values make the mosaic coarser.
</dd>
</dl>

</dd>


<dt>turn</dt>
<dd>
The "turn" transition creates an effect like many small cards flipping over.<r/>
<r/>
<img src="turn_trans.jpg"/><r/>
<r/>
 The following options are available.<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>bgcolor</dt>
<dd>
 Specifies the background color in 0xRRGGBB format.
</dd>
</dl>

</dd>


<dt>rotatezoom</dt>
<dd>
The "rotatezoom" transition zooms in or out while rotating the transition source ( the back buffer in KAG ).<r/>
<r/>
<img src="rotatezoom_trans.jpg"/><r/>
<r/>
 The following options are available.<r/>
<r/>
<dl>
<dt>time (Required)</dt>
<dd>
 Specifies the duration of the transition in milliseconds.
</dd>

<dt>factor</dt>
<dd>
 Specifies the initial magnification factor. 0: invisible at first, zooms in while rotating from the center. 2: zooms out from 2x magnification to 1x while rotating. Values of 3 or higher or real numbers can also be specified. Default is 1 ( 1x magnification ).
</dd>

<dt>accel</dt>
<dd>
 Specifies whether the scaling operation is performed with acceleration. A negative number of -2 or less starts fast and gradually slows down. A positive number of 2 or more starts slow and gradually speeds up. 0 results in linear movement, though it may not appear linear due to visual effects. Default is 0.
</dd>

<dt>twist</dt>
<dd>
 Specifies the direction and amount of rotation. Positive values rotate counter-clockwise. Negative values rotate clockwise. The value specifies the number of rotations. Default is 2.
</dd>

<dt>twistaccel</dt>
<dd>
 Specifies whether the rotation operation is performed with acceleration. A negative number of -2 or less starts fast and gradually slows down. A positive number of 2 or more starts slow and gradually speeds up. 0 results in linear movement. Default is -2.
</dd>
</dl>

</dd>


<dt>rotatevanish</dt>
<dd>
The "rotatevanish" transition zooms out while rotating the transition destination ( the front buffer in KAG ).<r/>
<r/>
<img src